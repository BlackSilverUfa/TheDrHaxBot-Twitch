(

$positive := [
    '–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ –¥–∞ NODDERS',
    '–º–æ–∂–µ—à—å –±—ã—Ç—å —É–≤–µ—Ä–µ–Ω –≤ —ç—Ç–æ–º NODDERS',
    '–Ω–∏–∫–∞–∫–∏—Ö —Å–æ–º–Ω–µ–Ω–∏–π NODDERS',
    '–∞–±—Å–æ–ª—é—Ç–ª–∏ NODDERS',
    '–Ω—É –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ NODDERS',
    '–¥–∞ NODDERS'
];

$plausible := [
    '—Ö–æ—Ä–æ—à–∏–µ —à–∞–Ω—Å—ã SeemsGood',
    '–≤–µ—Ä–æ—è—Ç–Ω–µ–µ –≤—Å–µ–≥–æ SeemsGood',
    '–¥—É–º–∞—é, —á—Ç–æ –¥–∞ SeemsGood',
    '–Ω–µ –∏—Å–∫–ª—é—á–µ–Ω–æ SeemsGood',
    '–Ω–µ–º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ SeemsGood'
];

$uncertain := [
    '–ø–æ–∫–∞ –Ω–µ —è—Å–Ω–æ peepoThink',
    '–Ω–µ —É–≤–µ—Ä–µ–Ω peepoThink',
    '—Ç—É—Ç –≤—Å—ë –Ω–µ —Ç–∞–∫ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ peepoThink',
    '—Å–∫–∞–∂—É –∑–∞ –Ω–µ–±–æ–ª—å—à—É—é —Å—É–º–º—É, BSUDAI',
    '–Ω–µ —Å—Ç–æ–∏—Ç –≤—Å–∫—Ä—ã–≤–∞—Ç—å —ç—Ç—É —Ç–µ–º—É. –í—ã –º–æ–ª–æ–¥—ã–µ, —à—É—Ç–ª–∏–≤—ã–µ, –≤–∞–º –≤—Å–µ –ª–µ–≥–∫–æ. –≠—Ç–æ –Ω–µ —Ç–æ. –ü–æ–≥–∏–±–Ω—É—Ç –í–°–Å monkaGunshake'
];

$unplausible := [
    '–¥–∞ –Ω–µ—Ç, –Ω–∞–≤–µ—Ä–Ω–æ–µ BSUHee',
    '—à–∞–Ω—Å—ã –Ω–µ –æ—á–µ–Ω—å BSUHee',
    '—Å–∫–æ—Ä–µ–µ –Ω–µ—Ç, —á–µ–º –¥–∞ BSUHee',
    '—è –±—ã –Ω–µ –Ω–∞–¥–µ—è–ª—Å—è BSUHee'
];

$negative := [
    '–¥–∞–∂–µ –Ω–µ –Ω–∞–¥–µ–π—Å—è NOPERS',
    '–≤–µ—Å—å–º–∞ —Å–æ–º–Ω–∏—Ç–µ–ª—å–Ω–æ NOPERS',
    '–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ –Ω–µ—Ç NOPERS',
    '–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ö–†–ê–ô–ù–ï –º–∞–ª–∞ NOPERS',
    '–Ω–∏–∫–æ–≥–¥–∞ –≤ –∂–∏–∑–Ω–∏ NOPERS',
    '–Ω–µ—Ç, –ø—Ä–æ—Å—Ç–æ –Ω–µ—Ç NOPERS'
];

$continuations := [
    '–∞ –≤—Å—ë—ë—ë BSUHee',
    '–∞–Ω—è ANYA',
    '–∞–Ω–ª–∞–∫–∏ BSUHee',
    '–∞–ª–ª–æ peepoPhone',
    '–∞–¥–∞, —è –ª—é–±–ª—é —Ç–µ–±—è ANYA',
    '–∞–±—Å–æ–ª—é—Ç–ª–∏ NODDERS',
    '–∞—ã–∞—ã–∞ ANYA',
    '–∞—É—Ñ üê∫',
    '–∞–ø—á—Ö–∏ ANYA',
    '–∞–º–∞–º–∞–º popCat',
    '–∞–º–æ–≥—É—Å ‡∂û',
    '–∞—è—è AYAYA',
    '–∞–≥–∞ NODDERS',
    'ass gachiBASS',
    '–∞–≤–∞–≤–∞–≤–∞ MEGALUL',
    
    '–±–∞–Ω monkaBan',
    '–±–∞—Ç–∞—Ç BSULoot',
    '–±—É–±–∞ BOOBA',
    '–±–æ—Ä—è CatCrying',
    '–±–æ—Ä–æ–¥–∞ popCat',
    '–±–ª—é–π –ø–µ–π dead5What MedTime',
    
    '–≤–µ—Ä—Ç—É—Ñ–∞–π–∑–µ–Ω bUrself',
    '–≤—ã –ø—Ä–æ–¥–æ—ë—Ç–µ —Ä—ã–±–æ–≤? ANYA',
    '–≤—ã—Ö–æ–¥–Ω–æ–π PeepoComfy',

    '–≥–∏–≤–∞—Å–∞—Å–∞–π monkaChrist',

    '–æ–æ–æ, —ç–ª–¥–µ–Ω —Ä–∏–Ω–≥ KOgasm',
    '–æ–ø –æ–ø PepoG',
    '–æ–ø –ø–∞ Pepega',
    '–æ–ø–æ–ª–∑–µ–Ω—å popCat',
    '–æ–≥–Ω–µ–æ–ø–∞—Å–Ω–æ gachiOnFIRE',

    '–º–∏—Ñ–∞ BibleThump',
    '–º–∏–ª–∞ AYAYA',
    '–º–µ–≥–∞–º–∞–∫–∏ gachiHYPER',
    
    '–Ω—É –î–∏–∏–∏–º–∞ Jebaited',
    
    '—Ä–µ–∞–∫—Ü–∏—è –º–∞–Ω–≥—É—Å—Ç–∞ Pepega',
    
    '—Å–∫–∞–π—Ä–∏–º toddW',
    '—Å–æ—Å –º—ã—Å–ª–æ–º ANYA',
    '—Å–æ–≤ –ø–∞–¥–µ–Ω–∏–µ BSUbl',
    '—Å—É–ø–µ—Ä NODDERS',

    '–∏—Å–ø–∞–Ω—Ü—ã! BSURage',
    '–∏–≥—Ä—ã NODDERS',
    '–∏–≥–æ—Ä—å —Ç–æ–Ω–µ—Ç CatCrying',
    '–∏—Ç–∞–Ω ariW',

    '—É–ª—å BSUWait',
    '—É–≤—É UwU',
    '—É—É—É—É–£–£–£–£ BSUbl',

    '–ø–µ—Ä–µ–∏–≥—Ä–∞—é –∏ —É–Ω–∏—á—Ç–æ–∂—É maestroW',
    '–ø–ª–∞–Ω–µ—Ä –¥–∞–π Jebaited',
    '–ø–æ–≤—Ç–æ—Ä NODDERS',
    '–ø–æ–ø–æ–ª–∑–µ–Ω—å popCat',
    '–ø–∏–ø–∞ PETTHEPEEPO',
    '–ø–æ–ø–∞ peepoGiggles',
    '–ø–æ–Ω–∏–º–∞—é NODDERS',
    '–ø–æ–ø–æ–ª–∞ AYAYA',
    '–¥–µ–≤–æ–ª–∞ AYAYA',
    
    '—Ç–∞—à–æ–Ω CatCrying',
    
    '–∫–± ANYA',
    '–∫—É–ª—è-–±—É–ª—è ANYA',
    '–∫—É–ª—è–ª—è ANYA',
    '–∫—É–∫—É, –∏–ø—Ç–∞ ANYA',
    '–∫—É–∫—É—Å–∏–∫–∏ NomNom',
    '–∫—É–ø–∏ toddW',
    '–∫—Ä—ã–∂–æ–≤–Ω–∏–∫ —Ç–µ—Ä–ø–∫–∏–π, —Å–ª–∞–¥–∫–∞—è —Å–∏—Ä–µ–Ω—å ANYA',
    '–∫–æ–¥–∑–∏–º–∞ –≥–µ–Ω–∏–π Kojimaptyp',
    '–∫–æ–∑–∏ peepoBlanket',
    '–∫—Ç—É–ª—Ö—É —Ñ—Ö—Ç–∞–≥–Ω Squid1 Squid2 Squid3 Squid4',
    
    '—Ñ—ç–º—ç–ª—ç ANYA',
    
    '—ã–∞—ã–∞—ã ANYA',
    
    '—Ö—É–±–∏–∫–∏ ANYA',
    
    '—ç–±–±–∏ pepeSmack',
    '—ç–Ω–≤–∞–π—Ä–æ–Ω–º–µ–Ω—Ç–∞–ª —Å—Ç–æ—Ä–∏—Ç–µ–ª–ª–∏–Ω–≥ ANYA'
];

$choose := function ($l) {(
    $id := $floor($random() * $count($l));
    $l[$id]
)};

$choice := function ($x) {
    $choose([
        '—Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ ' & $x & ' peepoThink',
        '–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ ' & $x & ' NODDERS',
        $x & ' ‚Äî –Ω–∞—à –≤—ã–±–æ—Ä SeemsGood',
        '–º–Ω–µ –∫–∞–∂–µ—Ç—Å—è, —á—Ç–æ ' & $x & ' peepoThink',
        '–∫–æ–Ω–µ—á–Ω–æ –∂–µ ' & $x & ' NODDERS'
    ])
};

$indexOf := function($list, $item) {
    ($list ~> $map(function($x, $i) {
        $x = $item ? $i : null
    }) ~> $filter(function($x) { $x != null }))[0]
};

$translate := function($text, $from, $to) {(
    $from := $split($from, '');
    $to := $split($to, '');

    $text
        ~> $split('')
        ~> $map(function($x) {(
            $index := $from ~> $indexOf($x);
            $index != null ? $to[$index] : $x
        )})
        ~> $join()
)};

$distinctStr := function ($x) {
    $x ~> $split('') ~> $map(function($y, $i) {
        $y ~> $match(/[–∞–µ–∏–æ—É—ã—ç]/) and $substring($x, $i + 1, 1) = $y ? '' : $y
    }) ~> $join()
};

$startsWith := function ($x, $y) {(
    $substring($x, 0, $length($y)) = $y
)};

$startsWithAny := function ($x, $list) {
    $map($list, function($y) { $startsWith($x, $y) }) ~>
    $filter(function ($v) { $v = true }) ~> $count > 0
};

$continue := function($text) {(
    $text := $text
        ~> $lowercase
        ~> $translate('a', '–∞')
        ~> $distinctStr
        ~> $replace(/\.*$/, '');

    $length($text) = 0 ? null :

    $continuations ~> $map(function($x) {
        $startsWith($x ~> $translate('a', '–∞'), $text) ? (
            $substring($x, $length($text))
        ) : null
    }) ~> $filter(function($x) { $x }) ~> $choose
)};

$emotes := emotes ~> $keys ~> $map(function ($k) { $lookup(emotes, $k) });

(parsed.query ~> $length = 0) ? (
    $choose([
        '—á—Ç' & (
            $match(payload.message, /!—à+([–∞–æ]+)—Ä+/i).groups[0]
            ~> $translate('–ê–∞–û–æ', '–û–æ–ê–∞')
        ) & '? Jebaited',
        (
            $match(payload.message, /!—à+([–∞–æ]+)—Ä+/i).groups[0]
            ~> $translate('–û–æ', '–ê–∞')
        ) & '? Jebaited'
    ])
) :
(parsed.query ~> $match(/ (–∏–ª–∏|or) /)) ? (
    $options := parsed.query
        ~> $substringBefore('?') ~> $replace(/ (–∏–ª–∏|or) /, ', ')
        ~> $split(',') ~> $map(function ($i) { $trim($i) });

    $options := $startsWithAny($options[0] ~> $lowercase, [
        '–≤–æ —á—Ç–æ',
        '—á—Ç–æ',
        '–∫–∞–∫',
        '–≥–¥–µ',
        '–∫—É–¥–∞',
        '–∫–æ–≥–¥–∞',
        '–∫—Ç–æ'
    ]) ? $options[[1..$count($options)]] : $options;

    ($count($options) = 2 and '–Ω–µ ' & $options[0] = $options[1]) ? '–≤–æ—Ç –≤ —á—ë–º –≤–æ–ø—Ä–æ—Å Kojimaptyp' :
    ($count($options) = 2 and 'not ' & $options[0] = $options[1]) ? 'that is the question Kojimaptyp' :
    ($count($options) = 2 and $options[0] = $options[1]) ? '–¥–∞ NODDERS' :
    (
        $choice($choose($options))
    );
) :
(parsed.query ~> $match(/–æ—Ç [+-]?[0-9]+ –¥–æ [+-]?[0-9]+/i)) ? (
    $range := (parsed.query ~> $match(/–æ—Ç ([+-]?[0-9]+) –¥–æ ([+-]?[0-9]+)/i)).groups
        ~> $map(function ($v) { $number($v ~> $replace(/\+/, '')) }) ~> $sort;

    $x := $range[1] - $range[0];
    $x := $random() * $x * 1.2 + $range[0] - $x * 0.1;

    $x > $range[1] ? '–¥—É–º–∞—é, —á—Ç–æ –±–æ–ª—å—à–µ NODDERS' :
    $x < $range[0] ? '–¥—É–º–∞—é, —á—Ç–æ –º–µ–Ω—å—à–µ NOPERS' :
    $choice($round($x))
) :
(parsed.query_filtered in $emotes) ? (
    parsed.query_filtered
) :
(parsed.query_filtered ~> $continue) ? (
    '...' & $continue(parsed.query_filtered)
) :
(parsed.query_filtered ~> $match(/^–ø–∏–Ω–≥/i)) ? (
    "–ø–æ–Ω–≥ Pepega"
) :
(parsed.query ~> $match(/^–º–æ–∂–µ—Ç —á–∞–π–∫—É/)) ? '–∞ –º–æ–∂–µ—Ç —Ç–µ–±—è?! Jebaited' :
(parsed.query ~> $match(/^—Ç—ã –ø–æ—Ç—Ä—è—Å–∞—é—â–∏–π/)) ? (
    $choose([
        '–¥–∞, —è —Ç–∞–∫–æ–π Kappa',
        '–Ω–µ—Ç, —Ç—ã –ø–æ—Ç—Ä—è—Å–∞—é—â–∏–π! keanU'
    ])
):
(parsed.query ~> $match(/^[UO][wœâv][UO]$/i)) ? $choose(['UœâU', '√≤œâ√≥', 'OœâO', '‡≤†_‡≤†']) :
(parsed.query ~> $match(/^(PETTHE|(–Ω–µ )?–ø–∏–ø(–∞–π|–Ω–∏|\ |$))/)) ? '–ø–∏–ø ' & $choose([
    'PETTHEPEEPO',
    'PETTHEAPTEEPO',
    'PETTHECAT',
    'PETTHEEVAN',
    'PETTHEMOD'
]) :
(
    $choose([
        $choose($positive),
        $choose($plausible),
        $choose($uncertain),
        $choose($unplausible),
        $choose($negative)
    ])
)

)
